<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=Cp1252" />
    <script src="getFactura/report.js" type="text/javascript"></script>
    <link href="getFactura/report.css" type="text/css" rel="stylesheet">
</head>

<body>

    <div class="banner">
        <table width="98%">
            <tr>
                <td>
                    <h2 class="banner">getFactura</h2>
                </td>
            </tr>
        </table>
    </div>

    <div id="maintabs">

        <div class="currentmaintab" onclick="onSelectMainTab(this, 0)">
            <div>
                <p>Doc</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 1)">
            <div>
                <p>Details</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 2)">
            <div>
                <p>Grants</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 3)">
            <div>
                <p>References</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 4)">
            <div>
                <p>Dependencies</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 5)">
            <div>
                <p>Code</p>
            </div>
        </div>

    </div>

    <br />

    <div id="masterreports">

        <div id="Master.0">
            <div class="currentmasterreport">

                <table cellspacing="0" cellpadding="1" width="100%" border="0">
                    <tr>
                        <td class="NavBarRow3" valign="top">
                            <font size="-2">
                                SUMMARY: <a href="#method_summary">METHOD</a>
                            </font>
                        </td>
                    </tr>
                </table>

                <hr>

                <a name="method_summary"></a>
                <table width="100%" cellspacing="0" cellpadding="3" border="1">

                    <tr class="TableHeadingColor">
                        <td colspan="2">
                            <font size="+2"><b>Method Summary</b></font>
                        </td>
                    </tr>

                    <tr class="TableRowColor">
                        <td width="1%" valign="top" align="right">
                            <font size="-1"><code>&nbsp;</code></font>
                        </td>
                        <td>
                            <code>
<b><a href="#getFactura">getFactura</a></b>
( p_Id_Factura IN INT )
</code>
                        </td>
                    </tr>

                </table>

                <p></p>

                <a name="method_detail"></a>
                <table width="100%" cellspacing="0" cellpadding="3" border="1">
                    <tr class="TableHeadingColor">
                        <td colspan="2">
                            <font size="+2"><b>Method Detail</b></font>
                        </td>
                    </tr>
                </table>

                <a name="getFactura"></a>

                <h3>getFactura</h3>

                <pre>
<B>getFactura</B>(
    p_Id_Factura IN INT
)
</pre>

                <dl>
                    <dd>
                        Procedimiento almacenado que obtiene la información de una factura
                        según su identificador y muestra los datos formateados mediante DBMS_OUTPUT.
                    </dd>
                </dl>

                <hr>

            </div>
        </div>

        <div id="Master.1">
            <div class="masterreport">

                <table id="Table.0" cellpadding="0" cellspacing="0">

                    <tr>
                        <th>NAME</th>
                        <th>VALUE</th>
                    </tr>

                    <tr>
                        <td>OWNER</td>
                        <td>ABBOTT</td>
                    </tr>
                    <tr>
                        <td>OBJECT_NAME</td>
                        <td>getFactura</td>
                    </tr>
                    <tr>
                        <td>OBJECT_TYPE</td>
                        <td>PROCEDURE</td>
                    </tr>
                    <tr>
                        <td>STATUS</td>
                        <td>VALID</td>
                    </tr>
                    <tr>
                        <td>TEMPORARY</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>GENERATED</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>EDITIONABLE</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>ORACLE_MAINTAINED</td>
                        <td>N</td>
                    </tr>

                </table>

            </div>
        </div>

        <div id="Master.2">
            <div class="masterreport">
                <table id="Table.1" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>PRIVILEGE</th>
                        <th>GRANTEE</th>
                        <th>GRANTABLE</th>
                        <th>GRANTOR</th>
                        <th>OBJECT_NAME</th>
                    </tr>
                </table>
            </div>
        </div>

        <div id="Master.3">
            <div class="masterreport">
                <table id="Table.2" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>NAME</th>
                        <th>OWNER</th>
                        <th>TYPE</th>
                        <th>STATUS</th>
                    </tr>

                    <tr>
                        <td>FACTURA</td>
                        <td>ABBOTT</td>
                        <td>TABLE</td>
                        <td>VALID</td>
                    </tr>

                    <tr>
                        <td>ERRORES_AUDIT</td>
                        <td>ABBOTT</td>
                        <td>TABLE</td>
                        <td>VALID</td>
                    </tr>

                </table>
            </div>
        </div>

        <div id="Master.4">
            <div class="masterreport">
                <table id="Table.3" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>DEPENDENCY_NAME</th>
                        <th>TYPE</th>
                    </tr>

                    <tr>
                        <td>FACTURA</td>
                        <td>TABLE</td>
                    </tr>

                    <tr>
                        <td>ERRORES_AUDIT</td>
                        <td>TABLE</td>
                    </tr>

                </table>
            </div>
        </div>

        <div id="Master.5">
            <div class="masterreport">
                <pre>
CREATE OR REPLACE PROCEDURE getFactura (
    p_Id_Factura INT
) IS
    v_fecha  FACTURA.fecha%TYPE;
    v_total  FACTURA.total%TYPE;
    v_estado FACTURA.estado%TYPE;
    v_mes     VARCHAR2(4000);
    v_cod     NUMBER;
BEGIN
    SELECT fecha, total, estado
    INTO v_fecha, v_total, v_estado
    FROM FACTURA
    WHERE Id_Factura = p_Id_Factura;
    
    DBMS_OUTPUT.PUT_LINE('=========================================');
    DBMS_OUTPUT.PUT_LINE('                FACTURA                  ');
    DBMS_OUTPUT.PUT_LINE('=========================================');
    DBMS_OUTPUT.PUT_LINE('Factura ID:       ' || p_Id_Factura);
    DBMS_OUTPUT.PUT_LINE('Fecha:            ' || TO_CHAR(v_fecha, 'DD-MON-YYYY'));
    DBMS_OUTPUT.PUT_LINE('-----------------------------------------');
    DBMS_OUTPUT.PUT_LINE('Total:            $' || TO_CHAR(v_total, '999,999.99'));
    DBMS_OUTPUT.PUT_LINE('-----------------------------------------');
    DBMS_OUTPUT.PUT_LINE('Estado:           ' || CASE v_estado
                                           WHEN 1 THEN 'Activo'
                                           ELSE 'Inactivo'
                                       END);
    DBMS_OUTPUT.PUT_LINE('=========================================');
    DBMS_OUTPUT.PUT_LINE('  ¡Gracias por su compra!                ');
    DBMS_OUTPUT.PUT_LINE('=========================================');
    
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('No se encontrÓ la factura con el ID ' || p_Id_Factura);
    WHEN OTHERS THEN
        v_mes := SQLERRM;
        v_cod := SQLCODE;
        INSERT INTO ERRORES_AUDIT VALUES (USER, 'EXISTE_USU',SYSDATE, v_cod || ' - '|| v_mes);
        DBMS_OUTPUT.PUT_LINE('Ocurrió un error: ' || v_mes);
END getFactura;
</pre>
            </div>
        </div>

    </div>

</body>

</html>

<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=Cp1252" />
    <script src="TRG_PRODUCTOS/report.js" type="text/javascript"></script>
    <link href="TRG_PRODUCTOS/report.css" type="text/css" rel="stylesheet">
</head>

<body>

    <div class="banner">
        <table width="98%">
            <tr>
                <td>
                    <h2 class="banner">TRG_PRODUCTOS</h2>
                </td>
            </tr>
        </table>
    </div>

    <div id="maintabs">

        <div class="currentmaintab" onclick="onSelectMainTab(this, 0)">
            <div>
                <p>Details</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 1)">
            <div>
                <p>Grants</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 2)">
            <div>
                <p>References</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 3)">
            <div>
                <p>Dependencies</p>
            </div>
        </div>

        <div class="maintab" onclick="onSelectMainTab(this, 4)">
            <div>
                <p>Code</p>
            </div>
        </div>

    </div>

    <br />

    <div id="masterreports">

        <div id="Master.0">
            <div class="currentmasterreport">
                <table id="Table.0" cellpadding="0" cellspacing="0" summary="">
                    <tr>
                        <th>NAME</th>
                        <th>VALUE</th>
                    </tr>
                    <tr>
                        <td>OWNER</td>
                        <td>ABBOTT</td>
                    </tr>
                    <tr>
                        <td>OBJECT_NAME</td>
                        <td>TRG_PRODUCTOS</td>
                    </tr>
                    <tr>
                        <td>SUBOBJECT_NAME</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>OBJECT_ID</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>DATA_OBJECT_ID</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>OBJECT_TYPE</td>
                        <td>TRIGGER</td>
                    </tr>
                    <tr>
                        <td>CREATED</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>LAST_DDL_TIME</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>TIMESTAMP</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>STATUS</td>
                        <td>VALID</td>
                    </tr>
                    <tr>
                        <td>TEMPORARY</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>GENERATED</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>SECONDARY</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>NAMESPACE</td>
                        <td>3</td>
                    </tr>
                    <tr>
                        <td>EDITION_NAME</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>SHARING</td>
                        <td>NONE</td>
                    </tr>
                    <tr>
                        <td>EDITIONABLE</td>
                        <td>Y</td>
                    </tr>
                    <tr>
                        <td>ORACLE_MAINTAINED</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>APPLICATION</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>DEFAULT_COLLATION</td>
                        <td>USING_NLS_COMP</td>
                    </tr>
                    <tr>
                        <td>DUPLICATED</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>SHARDED</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>IMPORTED_OBJECT</td>
                        <td>N</td>
                    </tr>
                    <tr>
                        <td>CREATED_APPID</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>CREATED_VSNID</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>MODIFIED_APPID</td>
                        <td>null</td>
                    </tr>
                    <tr>
                        <td>MODIFIED_VSNID</td>
                        <td>null</td>
                    </tr>
                </table>
            </div>
        </div>

        <div id="Master.1">
            <div class="masterreport">
                <table id="Table.1" cellpadding="0" cellspacing="0" summary="">
                    <tr>
                        <th>PRIVILEGE</th>
                        <th>GRANTEE</th>
                        <th>GRANTABLE</th>
                        <th>GRANTOR</th>
                        <th>OBJECT_NAME</th>
                    </tr>
                </table>
            </div>
        </div>

        <div id="Master.2">
            <div class="masterreport">
                <table id="Table.2" cellpadding="0" cellspacing="0" summary="">
                    <tr>
                        <th>NAME</th>
                        <th>OWNER</th>
                        <th>TYPE</th>
                        <th>OBJECT_ID</th>
                        <th>STATUS</th>
                        <th>TYPE_LINK</th>
                    </tr>
                </table>
            </div>
        </div>

        <div id="Master.3">
            <div class="masterreport">
                <table id="Table.3" cellpadding="0" cellspacing="0" summary="">
                    <tr>
                        <th>NAME</th>
                        <th>OWNER</th>
                        <th>TYPE</th>
                        <th>OBJECT_ID</th>
                        <th>STATUS</th>
                        <th>TYPE_LINK</th>
                    </tr>
                </table>
            </div>
        </div>

        <div id="Master.4">
            <div class="masterreport">
                <pre>
CREATE OR REPLACE TRIGGER TRG_PRODUCTOS 
    AFTER UPDATE OR INSERT OR DELETE ON Producto
    FOR EACH ROW
DECLARE
    VCOD NUMBER;
    VMES VARCHAR2(500);
BEGIN

    IF DELETING THEN
        INSERT INTO MENSAJE_TRIGGERS VALUES(USER,' SE HA BORRADO UN PRODUCTO:'|| :OLD.id_producto ||' '|| :OLD.nombre);
    ELSIF UPDATING THEN
        INSERT INTO MENSAJE_TRIGGERS VALUES(USER,' SE HA ACTUALIZADO UN PRODUCTO:'|| :OLD.id_producto ||' '|| :OLD.nombre||' '||:OLD.existencias||' '||:NEW.existencias);
    ELSIF INSERTING THEN
        INSERT INTO MENSAJE_TRIGGERS VALUES(USER,' SE HA INSERTADO UN PRODUCTO'|| :NEW.id_producto ||' '|| :NEW.nombre||' '||:NEW.existencias); 
    END IF;
    
EXCEPTION
    WHEN OTHERS THEN
        VMES := SQLERRM;
        VCOD := SQLCODE;
        INSERT INTO ERRORES_AUDIT (USUARIO, ORIGEN, FECHA, VERROR)
        VALUES (USER, 'TRG_PRODUCTOS', SYSDATE, VCOD || ' - ' || VMES);
END;
</pre>
            </div>
        </div>

    </div>

</body>

</html>
